<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Add VIDA to MetaMask</title>
<style>
  :root { --bg:#0b1c14; --card:#10251b; --text:#dff6e8; --muted:#9fe7c0; --btn:#39c18f; }
  body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
  .wrap{max-width:680px;margin:0 auto;padding:24px}
  .card{background:var(--card);border-radius:12px;padding:28px;text-align:center}
  h1{margin:0 0 8px;font-size:28px}
  p{margin:10px 0 0;line-height:1.5}
  code{background:#0e1f17;border:1px solid #1a3b2a;padding:2px 6px;border-radius:6px}
  button{margin-top:18px;padding:12px 18px;border:0;border-radius:10px;
         font-weight:700;color:#fff;background:var(--btn);cursor:pointer}
  .hint{color:var(--muted);font-size:14px;margin-top:14px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Add <span style="color:var(--muted)">VIDA</span> to MetaMask</h1>
    <p>Tap the button below. If prompted, allow the page to connect.</p>

    <button id="addVidaBtn">➕ Add VIDA to MetaMask</button>

    <p class="hint" id="status">Ready.</p>

    <p class="hint">Contract: <code id="addr">0x1D929E2422AEC567907f7fE2B966f7f84CA1858F</code><br/>
    Network: <code>Base (chainId 8453)</code></p>
  </div>
</div>

<script>
(async function () {
  const TOKEN = {
    address: "0x1D929E2422AEC567907f7fE2B966f7f84CA1858F",
    symbol: "VIDA",
    decimals: 18,
    image: "https://cdn.shopify.com/s/files/1/0664/1454/3080/files/Vida_coin_logo.jpg"
  };

  const BASE = {
    chainId: "0x2105", // 8453
    chainName: "Base Mainnet",
    rpcUrls: ["https://mainnet.base.org"],
    nativeCurrency: { name: "Ethereum", symbol: "ETH", decimals: 18 },
    blockExplorerUrls: ["https://basescan.org"]
  };

  const status = (msg) => { document.getElementById("status").textContent = msg; };

  async function switchToBase() {
    try {
      const current = await window.ethereum.request({ method: "eth_chainId" });
      if (current !== BASE.chainId) {
        try {
          await window.ethereum.request({
            method: "wallet_switchEthereumChain",
            params: [{ chainId: BASE.chainId }]
          });
        } catch (switchError) {
          // If Base isn't added yet, add it first
          if (switchError.code === 4902) {
            status("Adding Base Mainnet...");
            await window.ethereum.request({
              method: "wallet_addEthereumChain",
              params: [BASE]
            });
          } else throw switchError;
        }
      }
    } catch (err) {
      console.error(err);
      status("⚠️ Failed to switch to Base: " + err.message);
      throw err;
    }
  }

  async function addVida() {
    try {
      if (!window.ethereum) {
        status("MetaMask not detected. Open this page inside MetaMask’s Browser.");
        return;
      }
      status("Connecting wallet...");
      await window.ethereum.request({ method: "eth_requestAccounts" });
      await switchToBase();

      status("Adding VIDA token...");
      const added = await window.ethereum.request({
        method: "wallet_watchAsset",
        params: { type: "ERC20", options: TOKEN }
      });

      status(added ? "✅ VIDA added successfully!" : "❕ Request cancelled.");
    } catch (e) {
      console.error(e);
      status("⚠️ Unable to add token: " + (e.message || e));
    }
  }

  document.getElementById("addVidaBtn").addEventListener("click", addVida);
})();
</script>
</body>
</html>
